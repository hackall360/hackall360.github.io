---
interface ProjectLink {
  label: string;
  href: string;
}

interface Project {
  slug: string;
  title: string;
  summary: string;
  role: string;
  year: number;
  stack: string[];
  outcomes: string[];
  links: ProjectLink[];
  featured: boolean;
}

interface Props {
  project: Project;
}

const { project } = Astro.props as Props;
const tags = project.stack ?? [];
const outcomes = project.outcomes ?? [];
const primaryLink = project.links[0];
const secondaryLinks = project.links.slice(1);
const detailUrl = `/projects/${project.slug}`;
---
<article
  data-project-card
  data-tags={tags.map((tag) => tag.toLowerCase()).join(',')}
  data-motion-child
  data-motion-direction="up"
  class="group flex w-full flex-col justify-between rounded-3xl border border-accent/15 bg-surface-highlight/70 p-6 text-neutral-emphasis shadow-[0_30px_90px_-45px_rgba(34,211,238,0.4)] transition duration-300 ease-spring-out hover:border-accent/60 hover:shadow-glow focus-within:border-accent/60"
>
  <header class="flex flex-col gap-3">
    <div class="flex flex-wrap items-center gap-3 text-xs font-semibold uppercase tracking-wide text-neutral-soft">
      <span class="inline-flex items-center gap-2 rounded-full border border-accent/20 bg-surface-overlay/80 px-3 py-1 text-accent-light shadow-inner shadow-slate-950/40 transition group-hover:border-accent/60 group-hover:text-accent">
        <span class="size-2 rounded-full bg-accent-light shadow-[0_0_12px_rgba(34,211,238,0.6)]"></span>
        {project.year}
      </span>
      <span class="text-neutral-emphasis normal-case">{project.role}</span>
    </div>
    <h3 class="break-words text-xl font-semibold text-white transition group-hover:text-accent-light">
      <a class="break-words outline-none focus-visible:outline-none" href={detailUrl}>
        {project.title}
      </a>
    </h3>
  </header>

  <div class="mt-6 space-y-5">
    <p class="break-words text-sm leading-relaxed text-neutral-soft">{project.summary}</p>
    {outcomes.length > 0 && (
      <div class="space-y-2">
        <p class="text-xs font-semibold uppercase tracking-wide text-neutral-soft">Key outcomes</p>
        <ul class="space-y-2" role="list">
          {outcomes.map((outcome) => (
            <li class="flex gap-2 text-sm text-neutral-soft">
              <span aria-hidden="true" class="mt-1 size-1.5 rounded-full bg-accent-light shadow-[0_0_6px_rgba(34,211,238,0.7)]"></span>
              <span>{outcome}</span>
            </li>
          ))}
        </ul>
      </div>
    )}
    {tags.length > 0 && (
      <ul class="flex flex-wrap gap-2">
        {tags.map((tag) => (
          <li class="text-xs">
            <span class="inline-flex items-center rounded-full border border-accent/20 bg-surface-overlay/70 px-3 py-1 text-[0.7rem] font-medium uppercase tracking-wide text-neutral-emphasis transition group-hover:border-accent/50 group-hover:text-accent-light">
              {tag}
            </span>
          </li>
        ))}
      </ul>
    )}
  </div>

  <footer class="mt-6 flex flex-wrap items-center gap-3">
    <a
      class="inline-flex items-center justify-center gap-3 rounded-full border border-accent/25 bg-surface-overlay/80 px-4 py-2 text-sm font-semibold text-neutral-emphasis transition duration-200 ease-spring-out hover:border-accent hover:text-accent-light focus-visible:outline-none"
      href={detailUrl}
    >
      View case study
    </a>
    {primaryLink && (
      <a
        class="inline-flex items-center justify-center gap-3 rounded-full border border-transparent bg-accent px-4 py-2 text-sm font-semibold text-slate-950 shadow-sm shadow-accent/30 transition duration-200 ease-spring-out hover:bg-accent-light focus-visible:outline-none"
        href={primaryLink.href}
        rel={primaryLink.href.startsWith('http') ? 'noreferrer noopener' : undefined}
      >
        {primaryLink.label}
      </a>
    )}
    {secondaryLinks.map((link) => (
      <a
        class="inline-flex items-center justify-center gap-3 rounded-full border border-accent/25 bg-surface-overlay/80 px-4 py-2 text-sm font-semibold text-neutral-emphasis transition duration-200 ease-spring-out hover:border-accent hover:text-accent-light focus-visible:outline-none"
        href={link.href}
        rel={link.href.startsWith('http') ? 'noreferrer noopener' : undefined}
      >
        {link.label}
      </a>
    ))}
  </footer>
</article>
